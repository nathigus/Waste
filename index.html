<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Waste Sorter ‚Äî ‡πÄ‡∏ß‡πá‡∏ö‡∏Ñ‡∏±‡∏î‡πÅ‡∏¢‡∏Å‡∏Ç‡∏¢‡∏∞</title>
  <meta name="description" content="‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏õ‡∏Ñ‡∏±‡∏î‡πÅ‡∏¢‡∏Å‡∏Ç‡∏¢‡∏∞ ‚Äî ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏¢‡∏∞ ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ ‡πÅ‡∏•‡πâ‡∏ß‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏ó‡∏¥‡πâ‡∏á‡∏ñ‡∏±‡∏á‡πÑ‡∏´‡∏ô" />
  <style>
    :root{
      --bg:#f6fbf6;
      --card:#ffffff;
      --muted:#6b7280;
      --accent:#16a34a;
      --glass: rgba(255,255,255,0.6);
      --radius:12px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans", "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background: linear-gradient(180deg,#eaf5ea 0%, #f6fbf6 40%);
      color:#0f172a;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:28px;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .wrap{
      width:100%;
      max-width:980px;
      margin:12px;
      background:var(--card);
      border-radius:18px;
      box-shadow: 0 8px 30px rgba(12,34,12,0.08);
      overflow:hidden;
      display:grid;
      grid-template-columns: 1fr 380px;
      gap:0;
    }

    header.appbar{
      grid-column:1/-1;
      padding:18px 24px;
      display:flex;
      align-items:center;
      gap:12px;
      border-bottom:1px solid #eef3ee;
    }
    .logo {
      display:flex;
      gap:12px;
      align-items:center;
    }
    .logo .icon{
      width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#059669);display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:20px;
      box-shadow:0 4px 10px rgba(6,95,15,0.12);
    }
    header h1{font-size:18px;margin:0}
    header p{margin:0;color:var(--muted);font-size:13px}

    main.left{
      padding:22px;
    }

    .search-row{
      display:flex;
      gap:12px;
      align-items:center;
      margin-bottom:14px;
    }
    .search-row input[type="search"]{
      flex:1;
      padding:12px 14px;
      border-radius:12px;
      border:1px solid #e6eee6;
      font-size:15px;
      outline:none;
      background:linear-gradient(180deg,white, #fbfffb);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.6);
    }
    .search-row button{
      padding:10px 14px;
      background:var(--accent);
      border:none;color:white;border-radius:10px;font-weight:600;cursor:pointer;
    }

    .suggestions{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-bottom:14px;
    }
    .chip{
      background:#f1f8f1;border-radius:999px;padding:8px 12px;font-size:14px;color:#065f26;border:1px solid #e6f3e6;cursor:pointer;
    }

    .quick{
      display:flex;
      gap:10px;
      margin-bottom:18px;
      flex-wrap:wrap;
    }
    .quick button{
      padding:12px 14px;border-radius:12px;border:1px solid #eef5ee;background:white;cursor:pointer;font-weight:600;
    }

    .controls{
      display:flex;
      gap:10px;
      align-items:center;
      margin-bottom:14px;
    }
    .file-input{
      display:inline-flex;
      align-items:center;
      gap:8px;
      background:linear-gradient(180deg,#ffffff,#f7fff7);
      padding:10px;border-radius:12px;border:1px solid #eef6ee;
      cursor:pointer;
    }

    .preview{
      display:flex;
      gap:12px;
      margin-bottom:12px;
      align-items:center;
    }
    .preview img{max-width:120px;border-radius:10px;border:1px solid #eef7ee}

    .result-card{
      background:linear-gradient(180deg,#ffffff,#f7fff7);
      border-radius:12px;padding:14px;border:1px solid #ecf7ec;
      display:flex;gap:12px;align-items:center;
    }
    .result-icon{width:64px;height:64px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:26px;color:white;font-weight:700}
    .result-body h3{margin:0 0 6px 0}
    .result-body p{margin:0;color:var(--muted)}

    /* right column */
    aside.right{
      padding:20px;background:linear-gradient(180deg,#f8fff8,#ffffff);border-left:1px solid #eef6ee;
    }
    .history{
      max-height:60vh;overflow:auto;padding-right:6px;
    }
    .hist-item{display:flex;align-items:center;gap:10px;border-bottom:1px dashed #eef6ee;padding:10px 0}
    .small{font-size:13px;color:var(--muted)}

    footer.notes{grid-column:1/-1;padding:12px 20px;background:linear-gradient(180deg,#fbfff9,#ffffff);border-top:1px solid #eef6ee;font-size:13px;color:var(--muted);display:flex;justify-content:space-between;align-items:center}
    .btn-clear{background:transparent;border:1px solid #ffd2d2;color:#b91c1c;padding:8px 10px;border-radius:8px;cursor:pointer}

    /* responsive */
    @media(max-width:880px){
      .wrap{grid-template-columns:1fr; margin:12px}
      aside.right{order:3}
    }
  </style>
</head>
<body>
  <div class="wrap" id="app">
    <header class="appbar">
      <div class="logo">
        <div class="icon">WS</div>
        <div>
          <h1>Waste Sorter</h1>
          <p>‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏õ‡∏Ñ‡∏±‡∏î‡πÅ‡∏¢‡∏Å‡∏Ç‡∏¢‡∏∞ ‚Äî ‡∏Ñ‡πâ‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡πÅ‡∏•‡πâ‡∏ß‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏ó‡∏¥‡πâ‡∏á‡∏ñ‡∏±‡∏á‡πÑ‡∏´‡∏ô</p>
        </div>
      </div>
      <div style="margin-left:auto;">
        <small class="small">‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô: 1.0 ‚Ä¢ Offline-ready</small>
      </div>
    </header>

    <main class="left">
      <div class="search-row">
        <input id="q" type="search" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏¢‡∏∞ (‡πÄ‡∏ä‡πà‡∏ô ‡∏Ç‡∏ß‡∏î‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å, paper)..." />
        <button id="searchBtn">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
      </div>

      <div id="suggest" class="suggestions" aria-hidden="true"></div>

      <div class="quick" aria-hidden="false">
        <button data-name="‡∏Ç‡∏ß‡∏î‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å">‡∏Ç‡∏ß‡∏î‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å</button>
        <button data-name="‡πÄ‡∏®‡∏©‡∏≠‡∏≤‡∏´‡∏≤‡∏£">‡πÄ‡∏®‡∏©‡∏≠‡∏≤‡∏´‡∏≤‡∏£</button>
        <button data-name="‡∏Ç‡∏ß‡∏î‡πÅ‡∏Å‡πâ‡∏ß">‡∏Ç‡∏ß‡∏î‡πÅ‡∏Å‡πâ‡∏ß</button>
        <button data-name="‡∏ñ‡∏∏‡∏á‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å">‡∏ñ‡∏∏‡∏á‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å</button>
        <button data-name="‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà">‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà</button>
      </div>

      <div class="controls">
        <label class="file-input">
          <input id="file" type="file" accept="image/*" style="display:none" />
          üì∏ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à (Beta)
        </label>
        <button id="resetBtn" class="file-input">‚ôªÔ∏è ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
        <div style="margin-left:auto;color:var(--muted);font-size:13px">‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</div>
      </div>

      <div id="preview" class="preview" style="display:none">
        <img id="previewImg" src="" alt="preview" />
        <div>
          <div id="previewName" style="font-weight:700"></div>
          <div class="small" id="previewHint"></div>
        </div>
      </div>

      <div id="resultArea" style="margin-top:8px">
        <div class="result-card" id="placeholder">
          <div class="result-icon" style="background:#d1fae5;color:#065f46">‚ôªÔ∏è</div>
          <div class="result-body">
            <h3>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏∞‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</h3>
            <p>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏¢‡∏∞ ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ ‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏ó‡∏¥‡πâ‡∏á‡∏ñ‡∏±‡∏á‡πÑ‡∏´‡∏ô</p>
          </div>
        </div>
      </div>
    </main>

    <aside class="right">
      <h3 style="margin-top:0">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</h3>
      <div class="history" id="history"></div>
      <div style="margin-top:12px">
        <button id="exportBtn" class="file-input">‚¨áÔ∏è ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å CSV</button>
        <button id="clearHist" class="file-input" style="margin-left:8px;background:#fff0f0;border:1px solid #ffdddd;color:#b91c1c">‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</button>
      </div>
      <hr style="margin:12px 0;border:none;border-top:1px dashed #eef6ee" />
      <h4 style="margin:0 0 8px 0">‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô</h4>
      <ul style="margin:0;padding-left:18px;color:var(--muted);font-size:14px">
        <li>‡∏•‡πâ‡∏≤‡∏á‡∏á‡πà‡∏≤‡∏¢ ‡πÜ ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏¥‡πâ‡∏á‡∏Ç‡∏¢‡∏∞‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•</li>
        <li>‡πÅ‡∏¢‡∏Å‡∏ù‡∏≤‡πÅ‡∏•‡∏∞‡πÅ‡∏¢‡∏Å‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏´‡∏•‡∏≤‡∏¢‡∏ä‡∏ô‡∏¥‡∏î</li>
        <li>‡∏Ç‡∏¢‡∏∞‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î‡∏£‡∏±‡∏ö‡∏ó‡∏¥‡πâ‡∏á</li>
      </ul>
    </aside>

    <footer class="notes">
      <div>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ ‚ù§Ô∏è ‚Äî Waste Sorter</div>
      <div><button id="about" class="btn-clear">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö</button></div>
    </footer>
  </div>

  <script>
  // --- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏¢‡∏∞ (‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ç‡∏¢‡∏≤‡∏¢‡πÑ‡∏î‡πâ) ---
  const WASTE_DB = [
    {"name":"‡∏Ç‡∏ß‡∏î‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å","name_en":"plastic bottle","category":"‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•","advice":"‚ôªÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡∏£‡πà‡∏≤‡∏ß ‡πÜ ‡πÅ‡∏¢‡∏Å‡∏ù‡∏≤ ‡∏ó‡∏¥‡πâ‡∏á‡∏ñ‡∏±‡∏á‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏• (‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á)"},
    {"name":"‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ô‡∏°","name_en":"tetra pak","category":"‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•","advice":"‚ôªÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏ß‡∏°‡∏Ç‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏¥‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•"},
    {"name":"‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©","name_en":"paper","category":"‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•","advice":"‚ôªÔ∏è ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡πÉ‡∏´‡πâ‡πÅ‡∏´‡πâ‡∏á ‡∏ó‡∏¥‡πâ‡∏á‡∏ñ‡∏±‡∏á‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•"},
    {"name":"‡πÄ‡∏®‡∏©‡∏≠‡∏≤‡∏´‡∏≤‡∏£","name_en":"food waste","category":"‡∏Ç‡∏¢‡∏∞‡πÄ‡∏õ‡∏µ‡∏¢‡∏Å","advice":"üçÇ ‡∏ó‡∏¥‡πâ‡∏á‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞‡πÄ‡∏õ‡∏µ‡∏¢‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏≥‡∏õ‡∏∏‡πã‡∏¢‡∏´‡∏°‡∏±‡∏Å"},
    {"name":"‡∏ú‡πâ‡∏≤‡πÄ‡∏Å‡πà‡∏≤","name_en":"old clothes","category":"‡∏£‡∏µ‡∏¢‡∏π‡∏™/‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ","advice":"ü´∂ ‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ‡πÑ‡∏î‡πâ‡∏´‡∏≤‡∏Å‡∏™‡∏†‡∏≤‡∏û‡∏î‡∏µ"},
    {"name":"‡∏´‡∏•‡∏≠‡∏î‡πÑ‡∏ü‡πÅ‡∏ï‡∏Å","name_en":"broken bulb","category":"‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢","advice":"‚ò†Ô∏è ‡πÉ‡∏™‡πà‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏õ‡∏¥‡∏î‡∏°‡∏¥‡∏î‡∏ä‡∏¥‡∏î‡πÅ‡∏•‡∏∞‡πÑ‡∏õ‡∏ó‡∏¥‡πâ‡∏á‡∏à‡∏∏‡∏î‡∏£‡∏±‡∏ö‡∏ó‡∏¥‡πâ‡∏á‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢"},
    {"name":"‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà","name_en":"battery","category":"‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢","advice":"‚ò†Ô∏è ‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏¢‡∏Å ‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î‡∏£‡∏±‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå"},
    {"name":"‡∏ñ‡∏∏‡∏á‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å","name_en":"plastic bag","category":"‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ","advice":"üî• ‡∏ñ‡∏∏‡∏á‡∏ö‡∏≤‡∏á‡∏ä‡∏ô‡∏¥‡∏î‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î‡∏£‡∏±‡∏ö ‡πÅ‡∏ï‡πà‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏¥‡πâ‡∏á‡∏ñ‡∏±‡∏á‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ"},
    {"name":"‡∏Ç‡∏ß‡∏î‡πÅ‡∏Å‡πâ‡∏ß","name_en":"glass bottle","category":"‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•","advice":"‚ôªÔ∏è ‡∏•‡πâ‡∏≤‡∏á ‡∏ó‡∏¥‡πâ‡∏á‡∏ñ‡∏±‡∏á‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏• ‡πÅ‡∏¢‡∏Å‡∏ù‡∏≤"},
    {"name":"‡∏ã‡∏≠‡∏á‡∏õ‡∏£‡∏∏‡∏á‡∏£‡∏™","name_en":"seasoning sachet","category":"‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ","advice":"üî• ‡∏ó‡∏¥‡πâ‡∏á‡∏ñ‡∏±‡∏á‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏¢‡∏≤‡∏Å‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•"}
  ];

  // --- helpers ---
  function findWasteByQuery(q) {
    if(!q) return null;
    q = q.trim().toLowerCase();
    // exact name match first
    for(const it of WASTE_DB){
      if(it.name === q || it.name_en === q) return it;
    }
    // contains
    for(const it of WASTE_DB){
      if(it.name.toLowerCase().includes(q) || it.name_en.toLowerCase().includes(q)) return it;
    }
    return null;
  }

  function renderResult(item, source = '‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤') {
    const area = document.getElementById('resultArea');
    area.innerHTML = '';
    const card = document.createElement('div');
    card.className = 'result-card';
    const colorMap = {
      '‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•':'#10b981',
      '‡∏Ç‡∏¢‡∏∞‡πÄ‡∏õ‡∏µ‡∏¢‡∏Å':'#a16207',
      '‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ':'#374151',
      '‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢':'#ef4444',
      '‡∏£‡∏µ‡∏¢‡∏π‡∏™/‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ':'#0891b2'
    };
    const bg = colorMap[item.category] || '#6b7280';
    const iconText = {
      '‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•':'‚ôªÔ∏è',
      '‡∏Ç‡∏¢‡∏∞‡πÄ‡∏õ‡∏µ‡∏¢‡∏Å':'üçÇ',
      '‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ':'üóëÔ∏è',
      '‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢':'‚ö†Ô∏è',
      '‡∏£‡∏µ‡∏¢‡∏π‡∏™/‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ':'ü§ù'
    }[item.category] || 'üì¶';

    card.innerHTML = `
      <div class="result-icon" style="background:${lighten(bg,0.12)};color:white">${iconText}</div>
      <div class="result-body">
        <h3>${escapeHtml(item.name)} <small style="font-weight:600;margin-left:8px;color:${bg};padding:4px 8px;border-radius:8px;border:1px solid ${hexToRgba(bg,0.12)}">${item.category}</small></h3>
        <p>${escapeHtml(item.advice)}</p>
        <div style="margin-top:10px;display:flex;gap:8px">
          <button id="saveBtn" style="padding:8px 12px;border-radius:10px;border:none;background:${bg};color:white;cursor:pointer">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</button>
          <button id="shareBtn" style="padding:8px 12px;border-radius:10px;border:1px solid ${hexToRgba(bg,0.12)};background:transparent;cursor:pointer">‡πÅ‡∏ä‡∏£‡πå</button>
        </div>
      </div>
    `;
    area.appendChild(card);

    document.getElementById('saveBtn').addEventListener('click', () => {
      saveHistory(item, source);
      renderHistory();
      toast('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß');
    });
    document.getElementById('shareBtn').addEventListener('click', async () => {
      const txt = `${item.name} ‚Üí ${item.category}\n${item.advice}`;
      if(navigator.share){
        try { await navigator.share({title:'Waste Sorter', text:txt}); }
        catch(e){ console.log(e); alert('‡πÅ‡∏ä‡∏£‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'); }
      } else {
        copyToClipboard(txt);
        toast('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡πâ‡∏ß');
      }
    });
  }

  // --- UI wiring ---
  const qInput = document.getElementById('q');
  const searchBtn = document.getElementById('searchBtn');
  const suggestEl = document.getElementById('suggest');

  function updateSuggestions() {
    const q = qInput.value.trim().toLowerCase();
    suggestEl.innerHTML = '';
    if(!q) { suggestEl.style.display='none'; return; }
    const list = WASTE_DB.filter(it => it.name.toLowerCase().includes(q) || it.name_en.toLowerCase().includes(q)).slice(0,8);
    list.forEach(it => {
      const el = document.createElement('button');
      el.className = 'chip';
      el.textContent = it.name;
      el.addEventListener('click', ()=> {
        qInput.value = it.name;
        doSearch(it.name);
      });
      suggestEl.appendChild(el);
    });
    suggestEl.style.display = list.length ? 'flex' : 'none';
  }

  qInput.addEventListener('input', updateSuggestions);
  searchBtn.addEventListener('click', ()=> doSearch(qInput.value));
  qInput.addEventListener('keypress', (e)=> { if(e.key==='Enter') doSearch(qInput.value); });

  // quick buttons
  document.querySelectorAll('.quick button').forEach(b=>{
    b.addEventListener('click', ()=> {
      const n = b.getAttribute('data-name');
      qInput.value = n; updateSuggestions();
      doSearch(n);
    });
  });

  // file upload preview + simple detection (filename keyword)
  const fileInput = document.getElementById('file');
  const preview = document.getElementById('preview');
  const previewImg = document.getElementById('previewImg');
  const previewName = document.getElementById('previewName');
  const previewHint = document.getElementById('previewHint');

  fileInput.addEventListener('change', async (ev) => {
    const f = ev.target.files && ev.target.files[0];
    if(!f) return;
    const url = URL.createObjectURL(f);
    previewImg.src = url;
    preview.style.display = 'flex';
    previewName.textContent = f.name;
    previewHint.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏£‡∏π‡∏õ (heuristic)...';
    // simple detection by filename keywords
    const lowered = f.name.toLowerCase();
    let found = null;
    for(const it of WASTE_DB){
      if(lowered.includes(it.name.toLowerCase()) || lowered.includes(it.name_en)) { found = it; break; }
    }
    // fallback by reading image alt(exif?) not available: use color heuristic? we skip heavy ML here
    setTimeout(()=> {
      if(found) {
        previewHint.textContent = `‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô: ${found.name} ‚Äî ‡∏û‡∏ö‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå`;
        renderResult(found, '‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (filename)');
        saveHistory(found,'‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (filename)');
        renderHistory();
      } else {
        previewHint.textContent = '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏∞‡∏ö‡∏∏‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡∏•‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô';
        toast('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏°‡∏õ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‚Äî ‡πÉ‡∏´‡πâ‡∏•‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏∏‡πà‡∏°');
      }
    }, 600);
  });

  // reset
  document.getElementById('resetBtn').addEventListener('click', ()=> {
    qInput.value=''; preview.style.display='none'; document.getElementById('resultArea').innerHTML = document.getElementById('placeholder').outerHTML;
  });

  // basic search flow
  function doSearch(q) {
    if(!q || !q.trim()) { alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô'); return; }
    const item = findWasteByQuery(q);
    if(item) {
      renderResult(item, '‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤');
      saveHistory(item, '‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤');
      renderHistory();
    } else {
      // show friendly fallback
      renderNotFound(q);
    }
  }

  function renderNotFound(q) {
    const area = document.getElementById('resultArea');
    area.innerHTML = '';
    const card = document.createElement('div'); card.className='result-card';
    card.innerHTML = `
      <div class="result-icon" style="background:#fde68a;color:#92400e">‚ùì</div>
      <div class="result-body">
        <h3>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "${escapeHtml(q)}"</h3>
        <p>‡∏•‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏≠‡∏∑‡πà‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤</p>
        <div style="margin-top:10px">
          <button id="addBtn" style="padding:8px 12px;border-radius:10px;border:none;background:#f59e0b;color:white;cursor:pointer">‡∏Ç‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
        </div>
      </div>`;
    area.appendChild(card);
    document.getElementById('addBtn').addEventListener('click', ()=> {
      promptAddItem(q);
    });
  }

  // add item (local only)
  function promptAddItem(q) {
    const name = prompt('‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏¢‡∏∞ (‡πÑ‡∏ó‡∏¢):', q) || q;
    const nameEn = prompt('‡∏ä‡∏∑‡πà‡∏≠ (‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©) ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ:', '') || '';
    const category = prompt('‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó (‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏• / ‡∏Ç‡∏¢‡∏∞‡πÄ‡∏õ‡∏µ‡∏¢‡∏Å / ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ / ‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢ / ‡∏£‡∏µ‡∏¢‡∏π‡∏™/‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ):', '‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ') || '‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ';
    const advice = prompt('‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏±‡πâ‡∏ô‡πÜ:', '') || '';
    const newItem = {name, name_en: nameEn, category, advice};
    WASTE_DB.unshift(newItem);
    toast('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡∏Ç‡∏≠‡∏á‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ)');
    renderSuggestSample();
  }

  // history (localStorage)
  function saveHistory(item, source='‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤') {
    try {
      const key = 'ws_history_v1';
      const raw = localStorage.getItem(key);
      const arr = raw ? JSON.parse(raw) : [];
      arr.unshift({ts: Date.now(), name: item.name, category: item.category, source});
      localStorage.setItem(key, JSON.stringify(arr.slice(0,50)));
    } catch(e){ console.error(e); }
  }
  function renderHistory(){
    const key = 'ws_history_v1';
    const raw = localStorage.getItem(key);
    const arr = raw ? JSON.parse(raw) : [];
    const el = document.getElementById('history');
    el.innerHTML = '';
    if(arr.length===0){ el.innerHTML = '<div class="small">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</div>'; return; }
    arr.forEach(r=>{
      const d = new Date(r.ts);
      const node = document.createElement('div');
      node.className = 'hist-item';
      node.innerHTML = `<div style="width:44px;height:44px;border-radius:8px;background:${pickColor(r.category)};display:flex;align-items:center;justify-content:center;color:white;font-weight:700">${abbr(r.category)}</div>
      <div style="flex:1">
        <div style="font-weight:700">${escapeHtml(r.name)} <small style="color:var(--muted);font-weight:600">‚Ä¢ ${escapeHtml(r.category)}</small></div>
        <div class="small">${d.toLocaleString()} ‚Ä¢ ${escapeHtml(r.source)}</div>
      </div>
      <div style="margin-left:8px"><button style="border:none;background:transparent;color:#0ea5a2;cursor:pointer" data-name="${escapeHtml(r.name)}">‡∏Ñ‡πâ‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button></div>`;
      el.appendChild(node);
      node.querySelector('button').addEventListener('click', ()=> {
        doSearch(r.name);
      });
    });
  }

  document.getElementById('clearHist').addEventListener('click', ()=> {
    if(confirm('‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤?')) {
      localStorage.removeItem('ws_history_v1');
      renderHistory();
    }
  });

  document.getElementById('exportBtn').addEventListener('click', ()=> {
    const raw = localStorage.getItem('ws_history_v1');
    const arr = raw ? JSON.parse(raw) : [];
    if(arr.length===0){ alert('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å'); return; }
    const csv = ['timestamp,name,category,source'].concat(arr.map(r=> `${r.ts},"${r.name.replace(/"/g,'""')}",${r.category},${r.source}`)).join('\n');
    const blob = new Blob([csv],{type:'text/csv'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href=url; a.download='waste_history.csv'; a.click();
    URL.revokeObjectURL(url);
  });

  // About
  document.getElementById('about').addEventListener('click', ()=> {
    alert('Waste Sorter ‚Äî ‡πÄ‡∏ß‡πá‡∏ö‡∏Ñ‡∏±‡∏î‡πÅ‡∏¢‡∏Å‡∏Ç‡∏¢‡∏∞ (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)\n‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢: ‡∏Ñ‡∏∏‡∏ì\n‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô: 1.0\n\n‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠, ‡πÅ‡∏ó‡πá‡∏ö‡πÄ‡∏•‡πá‡∏ï ‡πÅ‡∏•‡∏∞‡∏û‡∏µ‡∏ã‡∏µ\n‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (localStorage)');
  });

  // util functions
  function toast(msg,timeout=2000){
    const t = document.createElement('div'); t.textContent = msg;
    Object.assign(t.style,{position:'fixed',left:'50%',transform:'translateX(-50%)',bottom:'28px',background:'#111',color:'#fff',padding:'10px 14px',borderRadius:'10px',opacity:'0',transition:'opacity .18s'});
    document.body.appendChild(t);
    requestAnimationFrame(()=>t.style.opacity='1');
    setTimeout(()=>{ t.style.opacity='0'; setTimeout(()=>t.remove(),220); },timeout);
  }
  function escapeHtml(s){ return String(s).replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }
  function hexToRgba(hex,alpha=1){
    const h=hex.replace('#','');
    const r=parseInt(h.substring(0,2),16), g=parseInt(h.substring(2,4),16), b=parseInt(h.substring(4,6),16);
    return `rgba(${r},${g},${b},${alpha})`;
  }
  function lighten(hex, amt=0.1){
    const h=hex.replace('#','');
    const r=Math.min(255, Math.floor(parseInt(h.substring(0,2),16) + 255*amt));
    const g=Math.min(255, Math.floor(parseInt(h.substring(2,4),16) + 255*amt));
    const b=Math.min(255, Math.floor(parseInt(h.substring(4,6),16) + 255*amt));
    return `rgb(${r},${g},${b})`;
  }
  function pickColor(cat){
    return ({'‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•':'#10b981','‡∏Ç‡∏¢‡∏∞‡πÄ‡∏õ‡∏µ‡∏¢‡∏Å':'#a16207','‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ':'#6b7280','‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢':'#ef4444','‡∏£‡∏µ‡∏¢‡∏π‡∏™/‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ':'#0891b2'}[cat]||'#6b7280');
  }
  function abbr(cat){
    return ({'‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•':'R','‡∏Ç‡∏¢‡∏∞‡πÄ‡∏õ‡∏µ‡∏¢‡∏Å':'P','‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ':'G','‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢':'!','‡∏£‡∏µ‡∏¢‡∏π‡∏™/‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ':'D'}[cat]||'?');
  }
  function copyToClipboard(text){
    if(navigator.clipboard) return navigator.clipboard.writeText(text);
    const ta = document.createElement('textarea'); ta.value=text; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove();
  }

  // initial render
  renderSuggestSample();
  renderHistory();

  function renderSuggestSample(){
    // prepopulate suggestion row with popular items
    const quickRow = document.querySelector('.suggestions');
    // leave if user is using search
  }

  // small UX: allow clicking history items to re-search added above
  // load placeholder (already there)
  </script>
</body>
</html>
